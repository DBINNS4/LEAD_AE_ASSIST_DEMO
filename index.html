<!DOCTYPE html>
<html lang="">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' file:; connect-src 'self' http://127.0.0.1:32123 ws://127.0.0.1:32123; script-src 'self' 'unsafe-eval' 'unsafe-inline' file:; style-src 'self' 'unsafe-inline'; img-src 'self' data:;">
  <title data-i18n="appTitle">LEAD AE ‚Äì ASSIST</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
      <div id="titlebar">
        <!-- üåô Light/Dark Mode Toggle -->
        <div class="theme-toggle-left">
          <input type="checkbox" id="theme-toggle" class="l" title="Toggle Light/Dark Mode">
        </div>

        <div id="panel-toolbar-wrapper">
          <div id="panel-toolbar"></div>
        </div>
      </div>
      <div class="title-divider"></div>
      <div id="window-content">

      <!-- ====================
           üìö Sidebar Navigation
           ==================== -->
      <aside class="sidebar">

      <ul>
        <!-- üîó Panel Navigation Tabs -->
        <li class="tab lae-navbtn" data-panel="speed-test">
          <span class="lae-navbtn__text" data-i18n="speedTest">Speed Test</span>
          <div class="lae-navtoggle" aria-hidden="true">
            <input class="lae-navtoggle-check" id="lae-navtoggle-speed-test" type="checkbox" tabindex="-1" aria-hidden="true">
            <label for="lae-navtoggle-speed-test" class="lae-navtoggle-label" aria-hidden="true">
              <div class="lae-navtoggle-line lae-navtoggle-line1"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line2"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line3"></div>
            </label>
          </div>
        </li>

        <li class="tab lae-navbtn" data-panel="project-organizer">
          <span class="lae-navbtn__text" data-i18n="projectOrganizer">Project Organizer</span>
          <div class="lae-navtoggle" aria-hidden="true">
            <input class="lae-navtoggle-check" id="lae-navtoggle-project-organizer" type="checkbox" tabindex="-1" aria-hidden="true">
            <label for="lae-navtoggle-project-organizer" class="lae-navtoggle-label" aria-hidden="true">
              <div class="lae-navtoggle-line lae-navtoggle-line1"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line2"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line3"></div>
            </label>
          </div>
        </li>

        <li class="tab lae-navbtn" data-panel="ingest">
          <span class="lae-navbtn__text" data-i18n="ingest">Ingest</span>
          <div class="lae-navtoggle" aria-hidden="true">
            <input class="lae-navtoggle-check" id="lae-navtoggle-ingest" type="checkbox" tabindex="-1" aria-hidden="true">
            <label for="lae-navtoggle-ingest" class="lae-navtoggle-label" aria-hidden="true">
              <div class="lae-navtoggle-line lae-navtoggle-line1"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line2"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line3"></div>
            </label>
          </div>
        </li>

        <li class="tab lae-navbtn" data-panel="transcode">
          <span class="lae-navbtn__text" data-i18n="transcode">Transcode</span>
          <div class="lae-navtoggle" aria-hidden="true">
            <input class="lae-navtoggle-check" id="lae-navtoggle-transcode" type="checkbox" tabindex="-1" aria-hidden="true">
            <label for="lae-navtoggle-transcode" class="lae-navtoggle-label" aria-hidden="true">
              <div class="lae-navtoggle-line lae-navtoggle-line1"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line2"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line3"></div>
            </label>
          </div>
        </li>

        <li class="tab lae-navbtn" data-panel="transcribe">
          <span class="lae-navbtn__text" data-i18n="transcribe">Transcribe</span>
          <div class="lae-navtoggle" aria-hidden="true">
            <input class="lae-navtoggle-check" id="lae-navtoggle-transcribe" type="checkbox" tabindex="-1" aria-hidden="true">
            <label for="lae-navtoggle-transcribe" class="lae-navtoggle-label" aria-hidden="true">
              <div class="lae-navtoggle-line lae-navtoggle-line1"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line2"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line3"></div>
            </label>
          </div>
        </li>

        <li class="tab lae-navbtn" data-panel="adobe-utilities">
          <span class="lae-navbtn__text" data-i18n="adobeAutomate">Adobe Automate</span>
          <div class="lae-navtoggle" aria-hidden="true">
            <input class="lae-navtoggle-check" id="lae-navtoggle-adobe-utilities" type="checkbox" tabindex="-1" aria-hidden="true">
            <label for="lae-navtoggle-adobe-utilities" class="lae-navtoggle-label" aria-hidden="true">
              <div class="lae-navtoggle-line lae-navtoggle-line1"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line2"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line3"></div>
            </label>
          </div>
        </li>

        <li class="tab lae-navbtn" data-panel="nle-utilities">
          <span class="lae-navbtn__text" data-i18n="nleUtilities">NLE Utilities</span>
          <div class="lae-navtoggle" aria-hidden="true">
            <input class="lae-navtoggle-check" id="lae-navtoggle-nle-utilities" type="checkbox" tabindex="-1" aria-hidden="true">
            <label for="lae-navtoggle-nle-utilities" class="lae-navtoggle-label" aria-hidden="true">
              <div class="lae-navtoggle-line lae-navtoggle-line1"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line2"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line3"></div>
            </label>
          </div>
        </li>

        <li class="tab lae-navbtn" data-panel="log-viewer">
          <span class="lae-navbtn__text" data-i18n="logViewer">Log Viewer</span>
          <div class="lae-navtoggle" aria-hidden="true">
            <input class="lae-navtoggle-check" id="lae-navtoggle-log-viewer" type="checkbox" tabindex="-1" aria-hidden="true">
            <label for="lae-navtoggle-log-viewer" class="lae-navtoggle-label" aria-hidden="true">
              <div class="lae-navtoggle-line lae-navtoggle-line1"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line2"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line3"></div>
            </label>
          </div>
        </li>

        <li class="tab lae-navbtn" data-panel="preferences">
          <span class="lae-navbtn__text" data-i18n="preferences">Preferences</span>
          <div class="lae-navtoggle" aria-hidden="true">
            <input class="lae-navtoggle-check" id="lae-navtoggle-preferences" type="checkbox" tabindex="-1" aria-hidden="true">
            <label for="lae-navtoggle-preferences" class="lae-navtoggle-label" aria-hidden="true">
              <div class="lae-navtoggle-line lae-navtoggle-line1"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line2"></div>
              <div class="lae-navtoggle-line lae-navtoggle-line3"></div>
            </label>
          </div>
        </li>
      </ul>

      <div class="sidebar-logo">
        <a href="https://www.leadae.com" target="_blank">
          <img src="images/lead_ae_logo.jpeg" alt="LEAD AE Logo">
        </a>
      </div>
      </aside>

<!-- ====================
 üìã Main Content Area
 ==================== -->
<main class="main-panel hidden">

<!-- ==================== ADOBE AUTOMATE PANEL ==================== -->

<div id="adobe-utilities" class="panel-section">
  <div class="section">
    <div id="adobe-lock-wrapper">
      <div class="panel-toolbar-controls">
      <button class="delete-preset-btn" data-panel="adobe-utilities" title="Delete Preset" disabled>üóëÔ∏è</button>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="" data-i18n="presetsPlaceholder">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="adobe-utilities-preset" name="adobe-utilities-preset">
      </div>
      <button id="save-config" data-i18n="save" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="save"></span></span></button>
      <button id="load-config" data-i18n="load" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="load"></span></span></button>
      <div class="tooltip-container">
        <div class="icon">
          <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12" y2="8"></line>
          </svg>
        </div>
        <div class="tooltip tooltip-bottom" id="automation-requirements-tooltip"></div>
      </div>
      <div class="reconnect-toolbar-button">
        <div class="container">
          <input type="checkbox" id="reconnect-checkbox">
          <label for="reconnect-checkbox" class="reconnect-switch" aria-label="Reconnect" title="Reconnect"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="slider"><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V256c0 17.7 14.3 32 32 32s32-14.3 32-32V32zM143.5 120.6c13.6-11.3 15.4-31.5 4.1-45.1s-31.5-15.4-45.1-4.1C49.7 115.4 16 181.8 16 256c0 132.5 107.5 240 240 240s240-107.5 240-240c0-74.2-33.8-140.6-86.6-184.6c-13.6-11.3-33.8-9.4-45.1 4.1s-9.4 33.8 4.1 45.1c38.9 32.3 63.5 81 63.5 135.4c0 97.2-78.8 176-176 176s-176-78.8-176-176c0-54.4 24.7-103.1 63.5-135.4z"></path></svg></label>
        </div>
      </div>
    </div>
    <!-- Input -->
    <h3 data-i18n="adobeInput">Input</h3>
    <div class="field-group horizontal">
      <button id="adobe-select-source" data-i18n="selectSource" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="selectSource"></span></span></button>
      <textarea id="adobe-source-path" data-i18n="noSourceSelected" placeholder="" readonly rows="1"></textarea>
    </div>

    <!-- ‚ñ∂ File & Metadata Grid (new) -->
    <div class="file-info-scroll">
      <div id="adobe-file-info" class="file-info-grid placeholder">
        <div class="file-info-grid-header" data-i18n="fileInfoColumnFile"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnFormat"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnResolution"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnFps"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnAudio"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnDuration"></div>
      </div>
    </div>
    <!-- Output -->
    <h3 data-i18n="adobeOutput">Output</h3>
    <div class="field-group horizontal">
      <button id="adobe-select-dest" data-i18n="selectDestination" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="selectDestination"></span></span></button>
      <input type="text" id="adobe-dest-path" data-i18n="noDestinationSelected" placeholder="" readonly>
    </div>

    <!-- Import Options -->
    <details>
      <summary><strong><span data-i18n="importOptions"></span></strong></summary>

      <div class="checkbox-grid spaced-top">
        <label><input type="checkbox" id="adobe-import-premiere"><span data-i18n="importIntoPremiere"></span></label>
        <label><input type="checkbox" id="adobe-generate-proxies"><span data-i18n="generateProxies"></span></label>
        <label><input type="checkbox" id="adobe-create-bins"><span data-i18n="createPremiereBins"></span></label>
      </div>

      <!-- Proxy Settings -->
      <div class="heading-with-tooltip">
        <h3 data-i18n="proxySettings"></h3>
        <div class="tooltip-container">
          <div class="icon">
            <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="16" x2="12" y2="12"></line>
              <line x1="12" y1="8" x2="12" y2="8"></line>
            </svg>
          </div>
          <div class="tooltip" id="proxy-settings-tooltip"></div>
        </div>
      </div>
      <div class="proxy-settings-wrapper">
        <div class="field-group horizontal" id="adobe-proxy-dest-row" style="display: none;">
          <button id="adobe-select-proxy-dest" data-i18n="selectProxyDestination" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="selectProxyDestination"></span></span></button>
          <input type="text" id="adobe-proxy-dest-path" data-i18n="noProxyDestinationSelected" placeholder="" readonly>
        </div>
        <div class="field-group" id="adobe-proxy-preset-wrapper" style="display: none;">
          <div class="dropdown-wrapper full-width">
            <div class="dropdown-display">
              <input class="chosen-value" type="text" placeholder="" data-i18n="selectProxyPreset">
              <span class="dropdown-arrow"></span>
            </div>
            <ul class="value-list"></ul>
            <input type="hidden" id="adobe-proxy-preset" name="adobe-proxy-preset">
          </div>
          <div class="field-group horizontal" id="adobe-proxy-preset-controls">
            <button id="load-proxy-preset" data-i18n="loadPreset" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="loadPreset"></span></span></button>
            <button id="refresh-proxy-presets" data-i18n="refresh" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="refresh"></span></span></button>
          </div>
        </div>
      </div>

      <!-- Unassigned Files -->
      <h3 data-i18n="unassignedFiles"></h3>
      <div class="field-group" id="source-file-selection">
        <label data-i18n="dragFilesIntoBins"></label>
        <ul id="source-file-list" class="draggable-list"></ul>
      </div>

      <!-- Bin Setup -->
      <h3 data-i18n="binSetup"></h3>
      <div class="field-group" id="adobe-bin-selection">
        <label data-i18n="dragBinsToOrder"></label>
        <ul id="adobe-bin-list" class="draggable-list"></ul>
      </div>
      <div class="field-group">
        <input type="text" id="adobe-folder-name" data-i18n="newBinName" placeholder="">
        <button id="add-folder" data-i18n="addBin" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="addBin"></span></span></button>
        <button id="add-subfolder" data-i18n="addSubBin" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="addSubBin"></span></span></button>
      </div>
    </details>

    <details>
      <summary class="heading-with-tooltip"><span class="summary-label" data-i18n="verificationLogging"></span>
        <div class="tooltip-container">
          <div class="icon">
            <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="16" x2="12" y2="12"></line>
              <line x1="12" y1="8" x2="12" y2="8"></line>
            </svg>
          </div>
          <div class="tooltip" id="verification-logging-tooltip"></div>
        </div>
      </summary>

      <div class="checkbox-grid spaced-top">
        <label>
          <div class="dropdown-wrapper dropdown-display">
            <input class="chosen-value" type="text" placeholder="" data-i18n="verificationMethod">
            <ul class="value-list"></ul>
            <span class="dropdown-arrow"></span>
            <input type="hidden" id="adobe-checksum-method" name="adobe-checksum-method">
          </div>
        </label>

        <label>
          <input type="checkbox" id="adobe-save-log">
          <span data-i18n="saveLog"></span>
        </label>
      </div>
    </details>

    <details data-webhook-section>
      <summary><strong><span data-i18n="automationIntegration"></span></strong></summary>

      <div class="checkbox-grid spaced-top">
        <label><input type="checkbox" id="adobe-enable-n8n"><span data-i18n="webhook"></span></label>
        <label><input type="checkbox" id="adobe-n8n-log"><span data-i18n="sendLog"></span></label>
      </div>
      <input type="text" id="adobe-n8n-url" placeholder="" data-i18n="webhookUrlPlaceholderSimple">
    </details>

    <details>
      <summary><strong><span data-i18n="ingestBehavior"></span></strong></summary>

      <div class="checkbox-grid spaced-top">
        <label><input type="checkbox" id="adobe-parallel"><span data-i18n="parallelCopy"></span></label>
        <label><input type="checkbox" id="adobe-auto-threads"><span data-i18n="autoThreads"></span></label>
        <label><input type="checkbox" id="adobe-retry-failures"><span data-i18n="retryFailures"></span></label>
      </div>

      <div class="field-group horizontal">
        <label><strong data-i18n="threads"></strong></label>
        <span id="adobe-concurrency-value">3</span>
        <input type="range" id="adobe-concurrency-slider" min="1" max="10">
      </div>
    </details>

    <!-- Ingest Controls -->
    <textarea id="adobe-notes" placeholder="" data-i18n="adobeAutomateNotes"></textarea>
    <div class="field-group adobe-controls-row" id="adobe-lock-controls">
      <button id="start-adobe-utilities" data-i18n="automate" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="automate"></span></span></button>
      <button id="reset-utilities" class="btn-danger button" data-i18n="reset"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="reset"></span></span></button>
      <button id="cancel-adobe-utilities" class="btn-danger button" data-i18n="cancel"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="cancel">Cancel</span></span></button>

      <!-- Progress bar + percent -->
      <div id="loader-inline">
        <progress id="adobe-progress" value="0" max="100"></progress>
        <output for="adobe-progress"></output>
      </div>

      <!-- ‚úÖ Hamster Wheel (right aligned) -->
      <div id="cep-job-status" style="display:none;">
        <div class="wheel-and-hamster"></div>
      </div>
    </div>
    </div>

    <ul id="cep-task-list" aria-live="polite"></ul>
    <h3><span data-i18n="summary"></span></h3>
    <textarea id="job-preview-box" class="status-log" aria-label="Job Preview" readonly rows="1"></textarea>
  </div>
</div>

  <!-- ==================== INGEST PANEL ==================== -->

<div id="ingest" class="panel-section">
  <div class="section">
    <div class="panel-toolbar-controls">
      <button class="delete-preset-btn" data-panel="ingest" title="Delete Preset" disabled>üóëÔ∏è</button>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="" data-i18n="presetsPlaceholder">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="ingest-preset" name="ingest-preset">
      </div>
      <button id="ingest-save-config" data-i18n="save" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="save"></span></span></button>
      <button id="ingest-load-config" data-i18n="load" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="load"></span></span></button>

      <!-- Ingest panel overview tooltip (top-right, like Adobe Automate) -->
      <div class="tooltip-container">
        <div class="icon">
          <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12" y2="8"></line>
          </svg>
        </div>
        <div class="tooltip tooltip-bottom" id="ingest-overview-tooltip"></div>
      </div>
    </div>

    <div id="ingest-lock-wrapper">

      <!-- Input -->
      <h3 data-i18n="ingestInput">Input</h3>
      <div class="field-group horizontal">
        <button id="select-source" data-i18n="selectSource" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="selectSource"></span></span></button>
        <input type="text" id="source-path" placeholder="" data-i18n="noSourceSelected" readonly>
      </div>

      <!-- Output -->
      <h3 data-i18n="ingestOutput">Output</h3>
      <div class="field-group horizontal">
        <button id="select-destination" data-i18n="selectDestination" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="selectDestination"></span></span></button>
        <input type="text" id="destination-path" placeholder="" data-i18n="noDestinationSelected" readonly>
      </div>
      <div class="field-group horizontal">
        <button id="select-backup" data-i18n="selectBackup" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="selectBackup"></span></span></button>
        <input type="text" id="backup-path" placeholder="" data-i18n="noBackupSelected" readonly>
      </div>
      <!-- Output & Clone Options -->
      <div class="checkbox-grid">
        <label><input type="checkbox" id="dualCopy"><span data-i18n="enableBackup"></span></label>
        <label><input type="checkbox" id="autoFolder"><span data-i18n="autoCreateFolder"></span></label>
        <label><input type="checkbox" id="enable-clone"><span data-i18n="cloneMode">Clone Mode</span></label>
      </div>

      <!-- Clone Section (revealed when enabled) -->
      <div id="clone-options" class="clone-options spaced-top">
        <h3><span data-i18n="folderFilters"></span></h3>
        <div class="field-group horizontal">
          <input type="text" id="clone-folder-filter" placeholder="" data-i18n="filterFoldersPlaceholder">
          <label><input type="checkbox" id="clone-select-all-folders"><span data-i18n="selectAll"></span></label>
          <label><input type="checkbox" id="clone-show-file-count"><span data-i18n="showFileCount"></span></label>

          <!-- Clone Mode tooltip ‚Äì same positioning style as Verification & Logging -->
          <div class="tooltip-container clone-mode-tooltip-container">
            <div class="icon">
              <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12" y2="8"></line>
              </svg>
            </div>
            <div class="tooltip" id="clone-mode-tooltip"></div>
          </div>
        </div>
        <div id="clone-folder-tree" class="status-log folder-tree"><span data-i18n="folderTreePlaceholder"></span></div>
      </div>

<!-- File Handling Options -->
<details>
  <summary><strong><span data-i18n="fileHandlingOptions"></span></strong></summary>

  <div class="checkbox-grid spaced-top">
    <label><input type="checkbox" id="skip-duplicates"><span data-i18n="skipDuplicates"></span></label>
    <label><input type="checkbox" id="flattenStructure"><span data-i18n="flattenStructure"></span></label>
  </div>

  <div class="field-group vertical-stack">
    <label for="filter-include" data-i18n="includeExtensions"></label>
    <input type="text" id="filter-include" placeholder=".mov,.mp4,.wav">
    <label for="filter-exclude" data-i18n="excludeExtensions"></label>
    <input type="text" id="filter-exclude" placeholder=".tmp,.db,.DS_Store">
  </div>

</details>

<details>
  <summary class="heading-with-tooltip"><span class="summary-label" data-i18n="verificationLogging"></span>
    <div class="tooltip-container">
      <div class="icon">
        <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12" y2="8"></line>
        </svg>
      </div>
      <div class="tooltip" id="verification-logging-tooltip"></div>
    </div>
  </summary>

  <div class="checkbox-grid spaced-top">
    <label>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="" data-i18n="verificationMethod">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="checksum-method" name="checksum-method">
      </div>
    </label>

    <label>
      <input type="checkbox" id="saveLog">
      <span data-i18n="saveLog"></span>
    </label>

  </div>

</details>

<!-- Ingest Behavior -->
<details data-webhook-section>
  <summary><strong><span data-i18n="automationIntegration"></span></strong></summary>

  <div class="checkbox-grid spaced-top">
    <label><input type="checkbox" id="enable-n8n"><span data-i18n="webhook"></span></label>
    <label><input type="checkbox" id="n8n-log"><span data-i18n="sendLog"></span></label>
  </div>
  <input type="text" id="n8n-url" placeholder="" data-i18n="webhookUrlPlaceholderSimple">

</details>

<!-- Ingest Behavior -->
<details>
  <summary><strong><span data-i18n="ingestBehavior"></span></strong></summary>
<div class="checkbox-grid spaced-top">
  <label><input type="checkbox" id="ingest-parallel"><span data-i18n="parallelCopy"></span></label>
  <label><input type="checkbox" id="ingest-auto-threads"><span data-i18n="autoThreads"></span></label>
  <label><input type="checkbox" id="ingest-retry-failures"><span data-i18n="retryFailures"></span></label>
</div>
<div class="field-group horizontal">
  <label><strong data-i18n="threads"></strong></label>
  <span id="concurrency-value">3</span>
  <input type="range" id="concurrency-slider" min="1" max="10">
</div>

</details>

<!-- Watch Mode -->
<details>
  <summary><strong><span data-i18n="watchMode"></span></strong></summary>

    <div class="checkbox-grid spaced-top">
      <label><input type="checkbox" id="enable-watch-mode"><span data-i18n="enableWatchMode"></span></label>
    </div>
    <div id="watch-backup-warning" class="alert warning" role="alert" style="display: none;">
      Backup paths and Dual Copy are disabled while Watch Mode is active.
    </div>
    <span id="ingest-watch-state" class="watch-state"></span>
    </details>
    </div> <!-- end of ingest-lock-wrapper -->

    <textarea id="notes" placeholder="" data-i18n="ingestNotes"></textarea>

    <!-- Controls -->
    <div id="ingest-lock-controls" class="field-group adobe-controls-row">
      <button id="start-ingest" data-i18n="startIngest" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="startIngest"></span></span></button>
      <button id="reset-ingest-fields" class="btn-danger button" data-i18n="resetIngest"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="resetIngest"></span></span></button>
      <button id="cancel-ingest" class="btn-danger button" data-i18n="cancelIngest"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="cancelIngest"></span></span></button>

      <!-- Inline loader (same placement as Adobe Automate) -->
      <div id="ingest-loader-inline">
        <progress id="ingest-progress" max="100" value="0" style="display:none"></progress>
        <output for="ingest-progress" id="ingest-progress-output"></output>
      </div>

      <!-- Hamster hard-right -->
      <div id="ingest-job-status" style="display:none;">
        <div class="wheel-and-hamster"></div>
      </div>
    </div>

    <!-- Job Preview -->
    <h3><span data-i18n="summary"></span></h3>
    <textarea id="ingest-job-preview-box" class="status-log" aria-label="Job Preview" readonly rows="1"></textarea>

  </div>
</div>

<!-- ====================
   TRANSCODE PANEL
==================== -->
<div id="transcode" class="panel-section">
  <div class="section">
    <div class="panel-toolbar-controls">
      <button class="delete-preset-btn" data-panel="transcode" title="Delete Preset" disabled>üóëÔ∏è</button>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="" data-i18n="presetsPlaceholder">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="transcode-preset" name="transcode-preset">
      </div>
      <button id="saveTranscodePreset" data-i18n="save" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="save"></span></span></button>
      <button id="loadTranscodePreset" data-i18n="load" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="load"></span></span></button>

      <!-- Transcode panel overview tooltip (top-right, like Ingest/Adobe) -->
      <div class="tooltip-container">
        <div class="icon">
          <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12" y2="8"></line>
          </svg>
        </div>
        <div class="tooltip tooltip-bottom" id="transcode-overview-tooltip"></div>
      </div>
    </div>

      <div id="transcode-lock-wrapper">

    <!-- Input -->
    <h3 data-i18n="transcodeInput">Input</h3>
    <div class="field-group">
        <button id="selectInputFiles" data-i18n="selectInputFiles" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="selectInputFiles"></span></span></button>
      <textarea id="inputFiles" placeholder="" data-i18n="noInputSelected" readonly rows="1"></textarea>
    </div>
    <div class="file-info-scroll">
      <div id="transcode-file-info" class="file-info-grid placeholder">
        <div class="file-info-grid-header" data-i18n="fileInfoColumnFile"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnFormat"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnResolution"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnFps"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnAudio"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnDuration"></div>
      </div>
    </div>

    <h3 data-i18n="transcodeOutput">Output</h3>
    <div class="field-group horizontal">
      <button id="selectOutput" data-i18n="selectOutput" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="selectOutput"></span></span></button>
      <input type="text" id="outputPath" placeholder="" data-i18n="noOutputSelected" readonly>
    </div>

<details>
    <summary>
    <strong><span data-i18n="videoSettings"></span></strong>
  </summary>

  <div class="checkbox-row">
    <label class="checkbox-label" for="transcode-match-source">
      <input type="checkbox" id="transcode-match-source">
      <span data-i18n="matchSource"></span>
    </label>
  </div>

  <div class="video-grid-3col">
    <!-- Column 1 -->
    <div class="form-item">
      <label for="outputFormat" data-i18n="outputFormat"></label>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="Output Format">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="outputFormat" name="outputFormat">
      </div>
    </div>
    <div class="form-item">
      <label for="containerFormat" data-i18n="containerFormat"></label>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="Container Format">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="containerFormat" name="containerFormat">
      </div>
    </div>
    <!-- Column 2 -->
    <div class="form-item">
      <label for="resolution" data-i18n="resolution"></label>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="Resolution">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="resolution" name="resolution">
      </div>
    </div>
    <div class="form-item">
      <label for="frameRate" data-i18n="frameRate"></label>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="Frame Rate">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="frameRate" name="frameRate">
      </div>
    </div>
    <div class="form-item">
      <label for="crf" data-i18n="crf"></label>
      <input type="number" id="crf" class="compact" placeholder="e.g. 23">
    </div>

    <!-- Column 3 -->
    <div class="form-item">
      <label for="pixelFormat" data-i18n="pixelFormat"></label>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="Pixel Format">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="pixelFormat" name="pixelFormat">
      </div>
    </div>
    <div class="form-item">
      <label for="colorRange" data-i18n="colorRange"></label>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="Color Range">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="colorRange" name="colorRange">
      </div>
    </div>
    <div class="form-item">
      <label data-i18n="lut"></label>
      <div id="transcode-lut-drop" class="dropdown-wrapper dropdown-display lut-dropzone">
        <input id="transcode-lut-display" class="chosen-value" type="text" placeholder="Drop LUT (.cube/.3dl/.dat) or click" data-i18n="lutDropPrompt" readonly>
        <span class="dropdown-arrow" aria-hidden="true"></span>
        <input type="hidden" id="transcode-lut-path">
      </div>
    </div>
    <div class="form-item">
      <label for="fieldOrder" data-i18n="fieldOrder"></label>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="Field Order">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="fieldOrder" name="fieldOrder">
      </div>
    </div>
  </div>

</details>

    <details>
      <summary><strong><span data-i18n="audioSettings"></span></strong></summary>

      <div class="checkbox-grid spaced-top">
        <label><input type="checkbox" id="transcode-audio-only"><span data-i18n="audioOnly"></span></label>
        <label><input type="checkbox" id="normalizeAudio"><span data-i18n="normalizeAudio"></span></label>
      </div>

      <div class="video-grid-3col">
        <div class="form-item">
          <label for="audioCodec" data-i18n="audioCodec"></label>
          <div class="dropdown-wrapper dropdown-display">
            <input class="chosen-value" type="text" placeholder="Audio Codec">
            <ul class="value-list"></ul>
            <span class="dropdown-arrow"></span>
            <input type="hidden" id="audioCodec" name="audioCodec">
          </div>
        </div>

        <div class="form-item">
          <label for="channels" data-i18n="channels"></label>
          <div class="dropdown-wrapper dropdown-display">
            <input class="chosen-value" type="text" placeholder="Channels">
            <ul class="value-list"></ul>
            <span class="dropdown-arrow"></span>
            <input type="hidden" id="channels" name="channels">
          </div>
        </div>

        <div class="form-item">
          <label for="sampleRate" data-i18n="sampleRate"></label>
          <div class="dropdown-wrapper dropdown-display">
            <input class="chosen-value" type="text" placeholder="Sample Rate">
            <ul class="value-list"></ul>
            <span class="dropdown-arrow"></span>
            <input type="hidden" id="sampleRate" name="sampleRate">
          </div>
        </div>

        <div class="form-item">
          <label for="audioBitrate" data-i18n="audioBitrate"></label>
          <div class="dropdown-wrapper dropdown-display">
            <input class="chosen-value" type="text" placeholder="Audio Bitrate">
            <ul class="value-list"></ul>
            <span class="dropdown-arrow"></span>
            <input type="hidden" id="audioBitrate" name="audioBitrate">
          </div>
        </div>

        <div class="form-item">
          <label for="audioDelay" data-i18n="audioDelay"></label>
          <input type="number" id="audioDelay" placeholder="e.g. 50" class="compact">
        </div>

      </div>
    </details>

    <details>
      <summary class="heading-with-tooltip"><span class="summary-label" data-i18n="verificationLogging"></span>
        <div class="tooltip-container">
          <div class="icon">
            <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="16" x2="12" y2="12"></line>
              <line x1="12" y1="8" x2="12" y2="8"></line>
            </svg>
          </div>
          <!-- Transcode-specific tooltip ID -->
          <div class="tooltip" id="transcode-verification-tooltip"></div>
        </div>
      </summary>

        <div class="checkbox-grid spaced-top">
          <label>
            <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="" data-i18n="verificationMethod">
            <ul class="value-list">
                <li data-value="metadata" data-i18n="transcodeVerificationDurationFrame">Duration / Frame</li>
                <li data-value="ssim_psnr" data-i18n="transcodeVerificationSsimPsnr">SSIM / PSNR</li>
              </ul>
            <span class="dropdown-arrow"></span>
            <input type="hidden" id="transcode-verification-method" name="transcode-verification-method" value="metadata">
          </div>
        </label>

        <label>
          <input type="checkbox" id="transcode-save-log">
          <span data-i18n="transcodeSaveLog"></span>
        </label>

      </div>
    </details>

    <details data-webhook-section>
      <summary><strong><span data-i18n="automationIntegration"></span></strong></summary>
      <div class="checkbox-grid spaced-top">
        <label><input type="checkbox" id="transcode-enable-n8n"><span data-i18n="webhook"></span></label>
        <label><input type="checkbox" id="transcode-n8n-log"><span data-i18n="sendLog"></span></label>
      </div>
      <input type="text" id="transcode-n8n-url" placeholder="" data-i18n="webhookUrlPlaceholderSimple">
    </details>

    <details id="transcode-watch-wrapper">
      <summary><strong><span data-i18n="watchMode"></span></strong></summary>
      <div class="checkbox-grid spaced-top">
        <label><input type="checkbox" id="transcode-watch-mode"><span data-i18n="transcodeWatchMode"></span></label>
        <span id="transcode-watch-state" class="watch-state"></span>
      </div>
    </details>

    <textarea id="transcode-notes" placeholder="" data-i18n="transcodeNotes"></textarea>

    <div class="field-group adobe-controls-row spaced-top" id="transcode-controls-row">
      <button id="startTranscode" data-i18n="startTranscode" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="startTranscode"></span></span></button>
      <button id="resetTranscode" class="btn-danger button" data-i18n="resetTranscode"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="resetTranscode"></span></span></button>
      <button id="cancelTranscode" class="btn-danger button" data-i18n="cancelTranscode"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="cancelTranscode"></span></span></button>
      <div id="transcode-loader-inline">
        <progress id="transcode-progress" max="100" value="0" style="display:none"></progress>
        <output for="transcode-progress" id="transcode-progress-output"></output>
      </div>
      <div id="transcode-job-status" style="display:none;">
        <div class="wheel-and-hamster"></div>
      </div>
    </div>

    </div> <!-- end of transcode-lock-wrapper -->

    <!-- Job Preview (matches Ingest/Adobe pattern; always shows all option states) -->
    <h3><span data-i18n="summary"></span></h3>
    <textarea id="transcode-job-preview-box" class="status-log" aria-label="Job Preview" readonly rows="1"></textarea>

  </div>
</div>

      <!-- =========================
     PROJECT ORGANIZER PANEL
     ========================= -->
<div id="project-organizer" class="panel-section">
  <div class="section">
    <div class="panel-toolbar-controls">
      <button class="delete-preset-btn" data-panel="organizer" title="Delete Preset" disabled>üóëÔ∏è</button>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="" data-i18n="presetsPlaceholder">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="organizer-preset" name="organizer-preset">
      </div>
      <button id="organizer-save-config" data-i18n="saveConfig" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="saveConfig"></span></span></button>
      <button id="organizer-load-config" data-i18n="loadConfig" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="loadConfig"></span></span></button>

      <!-- üîπ Project Organizer overview tooltip ‚Äì SAME POSITION AS INGEST/TRANSCODE -->
      <div class="tooltip-container">
        <div class="icon">
          <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12" y2="8"></line>
          </svg>
        </div>
        <div class="tooltip tooltip-bottom" id="project-organizer-overview-tooltip"></div>
      </div>
    </div>

    <div class="field-group">
      <label><input type="checkbox" id="prepend-numbers"><span data-i18n="prependNumbering"></span></label>
    </div>

    <!-- Folder Selection Panel -->
    <div class="field-group" id="folder-selection">
      <label data-i18n="dragFoldersToOrder"></label>
      <ul id="folder-list" class="draggable-list"></ul>
    </div>
    

    <!-- Custom Folder Input -->
    <div class="field-group">
  <input type="text" id="custom-folder-name" placeholder="" data-i18n="customFolderName">
  <button id="add-custom-folder" data-i18n="addCustomFolder" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="addCustomFolder"></span></span></button>
  <button id="organizer-add-subfolder" data-i18n="addSubfolder" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="addSubfolder"></span></span></button>
    </div>

    <!-- Root Naming Rules -->
    <div class="field-group project-name">
      <label for="root-folder-name" style="font-weight: 600; font-size: 1rem; margin-bottom: 0.25rem;"><span data-i18n="projectName"></span></label>
      <input type="text" id="root-folder-name" placeholder="" data-i18n="rootFolderPlaceholder">
    </div>
    
    <!-- Save Location Setup -->
    <div class="field-group">
      <button id="select-output-location" data-i18n="selectOutputLocation" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="selectOutputLocation"></span></span></button>
      <input type="text" id="output-location-path" placeholder="" data-i18n="outputPath" readonly>
    </div>

    <!-- Generate / Reset / Hamster (same row) -->
    <div id="project-organizer-controls-row" class="field-group adobe-controls-row">
      <button id="generate-project-folders" data-i18n="generateProjectFolders" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="generateProjectFolders"></span></span></button>
      <button id="reset-project-organizer" class="btn-danger button" data-i18n="resetProjectOrganizer"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="resetProjectOrganizer"></span></span></button>
      <button id="cancel-project-organizer" class="btn-danger button" data-i18n="cancelProjectOrganizer"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="cancelProjectOrganizer"></span></span></button>

      <!-- Hamster hard-right, same as other panels -->
      <div id="project-organizer-job-status" style="display:none;">
        <div class="wheel-and-hamster"></div>
      </div>
    </div>
        
    <!-- Folder Summary -->
    <h3><span data-i18n="summary"></span></h3>
    <div id="project-summary" class="status-log" data-i18n="noStructureDefined"></div>

  </div>
</div>


<!-- =========================
     NLE UTILITIES PANEL
     ========================= -->
<div id="nle-utilities" class="panel-section">
  <div class="section">
    <div class="panel-toolbar-controls">
      <button class="delete-preset-btn" data-panel="nle" title="Delete Preset" disabled>üóëÔ∏è</button>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="" data-i18n="presetsPlaceholder">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="nle-preset" name="nle-preset">
      </div>
      <button id="nle-save-config" data-i18n="saveConfig" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="saveConfig"></span></span></button>
      <button id="nle-load-config" data-i18n="loadConfig" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="loadConfig"></span></span></button>

      <!-- üîπ NLE Utilities overview tooltip (IN ROW, SAME POSITION AS OTHERS) -->
      <div class="tooltip-container">
        <div class="icon">
          <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12" y2="8"></line>
          </svg>
        </div>
        <div class="tooltip tooltip-bottom" id="nle-overview-tooltip"></div>
      </div>
    </div>

    <!-- Avid Utilities -->
  <details>
    <summary><strong><span data-i18n="avidUtilities"></span></strong></summary>

    <!-- Folder Selection -->
    <div class="field-group">
      <button id="avid-select-folder" data-i18n="avidSelectFolder" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="avidSelectFolder"></span></span></button>
      <input type="text" id="avid-folder-path" placeholder="" data-i18n="noAvidFolderSelected" readonly>
    </div>

    <!-- User Selection -->
    <div class="field-group">
      <label for="avid-user-select" data-i18n="avidUserLabel"></label>
      <select id="avid-user-select">
        <option value="" data-i18n="selectUser"></option>
      </select>
    </div>

    <!-- Primary Buttons -->
    <div class="field-group">
      <button id="avid-delete-db" class="btn-danger button" title="Folders should follow 'Avid MediaFiles/MXF' structure" data-i18n="avidDeleteDb"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="avidDeleteDb"></span></span></button>
      <button id="avid-reset-site" class="btn-danger button" data-i18n="avidResetSite"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="avidResetSite"></span></span></button>
      <button id="avid-reset-user" class="btn-danger button" data-i18n="avidResetUser"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="avidResetUser"></span></span></button>
    </div>

    <!-- Secondary Action -->
    <div class="field-group">
      <button id="avid-rebuild-db" title="Folders should follow 'Avid MediaFiles/MXF' structure" data-i18n="avidRebuildDb" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="avidRebuildDb"></span></span></button>
    </div>

    <!-- Shared Checkboxes -->
    <div class="field-group">
      <label><input type="checkbox" id="avid-scan-subfolders"><span data-i18n="avidScanSubfolders"></span></label>
      <label><input type="checkbox" id="avid-backup-settings"><span data-i18n="avidBackupSettings"></span></label>
      <label><input type="checkbox" id="avid-show-counts"><span data-i18n="avidShowCounts"></span></label>
      <label><input type="checkbox" id="avid-auto-rebuild"><span data-i18n="avidAutoRebuild"></span></label>
    </div>

    <!-- Summary Log -->
    <div class="status-log" id="avid-summary" data-i18n="avidSummary"></div>
  </details>

    <!-- Adobe Automate -->
    <details>
      <summary><strong><span data-i18n="adobeUtilities"></span></strong></summary>
      
      <div class="field-group">
       <button id="adobe-select-folder" data-i18n="adobeSelectFolder" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="adobeSelectFolder"></span></span></button>
       <input type="text" id="adobe-folder-path" placeholder="" data-i18n="noAdobeFolderSelected" readonly>
     </div>

      <!-- Cache and Autosave Controls -->
      <div class="field-group">
        <button id="adobe-clear-cache" class="btn-danger button" data-i18n="adobeClearCache"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="adobeClearCache"></span></span></button>
        <button id="adobe-delete-autosaves" class="btn-danger button" data-i18n="adobeDeleteAutosaves"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="adobeDeleteAutosaves"></span></span></button>
        <button id="adobe-remove-previews" class="btn-danger button" data-i18n="adobeRemovePreviews"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="adobeRemovePreviews"></span></span></button>
      </div>

      <!-- Cleanup Filters -->
      <div class="field-group">
        <label><input type="checkbox" id="adobe-skip-recent"><span data-i18n="adobeSkipRecent"></span></label>
        <input type="number" id="adobe-age-days" placeholder="" data-i18n="adobeAgeDays" min="1">
      </div>

      <div class="field-group">
        <label><input type="checkbox" id="adobe-size-skip"><span data-i18n="adobeSkipLarge"></span></label>
        <input type="number" id="adobe-size-mb" placeholder="" data-i18n="adobeSizeMb" min="1">
      </div>

      <div class="field-group">
        <input type="text" id="adobe-media-cache-filter" placeholder="" data-i18n="adobeMediaCacheFilter">
        <input type="text" id="adobe-media-cache-scope" placeholder="" data-i18n="adobeMediaCacheScope">
      </div>

    <div class="status-log" id="adobe-summary" data-i18n="adobeSummary"></div>
    </details>

    <!-- Full Panel Reset Button -->
    <div class="field-group spaced-top">
      <button id="reset-nle-utilities" class="btn-danger button" data-i18n="resetNleUtilities"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="resetNleUtilities"></span></span></button>
    </div>
    <!-- NLE Utilities: AI Assistants (below reset button) -->
    <div id="nle-utilities-assistants" class="nle-assistants-row">
      <div class="nle-assist-container">
          <a href="https://chatgpt.com/g/g-nb2UUpCxI-avid-media-composer" target="_blank" rel="noopener" class="nle-assist-button" id="btn-media-composer">
            <span class="nle-assist-label" data-i18n="nleAssistMediaComposer">Media Composer</span>
            <img src="images/OpenAI-black-monoblossom.png" alt="Media Composer assistant" class="nle-assist-logo">
        </a>
      </div>

      <div class="nle-assist-container">
        <a href="https://chatgpt.com/g/g-ifxhKCZmI-premiere-assistant" target="_blank" rel="noopener" class="nle-assist-button" id="btn-premiere">
            <span class="nle-assist-label" data-i18n="nleAssistPremiere">Premiere</span>
            <img src="images/OpenAI-black-monoblossom.png" alt="Premiere assistant" class="nle-assist-logo">
        </a>
      </div>

      <div class="nle-assist-container">
        <a href="https://chatgpt.com/g/g-wJL3QLpQ5-davinci-resolve-18-6-wizard" target="_blank" rel="noopener" class="nle-assist-button" id="btn-resolve">
            <span class="nle-assist-label" data-i18n="nleAssistResolve">Resolve</span>
            <img src="images/OpenAI-black-monoblossom.png" alt="Resolve assistant" class="nle-assist-logo">
        </a>
      </div>
    </div>
  </div>
</div>

<!-- ========================
     PREFERENCES PANEL
     ======================== -->
<div id="preferences" class="panel-section">
  <div class="section">
    <div class="panel-toolbar-controls">
      <button class="delete-preset-btn" data-panel="prefs" title="Delete Preset" disabled>üóëÔ∏è</button>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="" data-i18n="presetsPlaceholder">
          <ul class="value-list"></ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="prefs-preset" name="prefs-preset">
        </div>
        <button id="prefs-save-config" data-i18n="save" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="save">Save</span></span></button>
        <button id="prefs-load-config" data-i18n="load" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="load">Load</span></span></button>

      <!-- üîπ Preferences overview tooltip -->
      <div class="tooltip-container">
        <div class="icon">
          <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12" y2="8"></line>
          </svg>
        </div>
        <div class="tooltip tooltip-bottom" id="preferences-overview-tooltip"></div>
      </div>
    </div>

    <!-- General Preferences -->
    <h3 data-i18n="preferencesGeneral">General</h3>

    <div class="field-group checkbox-grid">
      <label><input type="checkbox" id="system-notifications"><span data-i18n="enableSystemNotifications"></span></label>
      <label><input type="checkbox" id="offline-mode"><span data-i18n="enableOfflineMode"></span></label>
    </div>


    <h3 data-i18n="themeAppearance"></h3>
    <div class="field-group horizontal">
      <!-- Theme -->
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" data-i18n="themePlaceholder" placeholder="Light/Dark">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="theme-select" name="theme-select">
      </div>

      <!-- Language -->
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" data-i18n="languagePlaceholder" placeholder="Language">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="language-select" name="language-select">
      </div>

    </div>

<!-- AI Settings -->
<h3 data-i18n="aiSettings"></h3>
<div class="field-group" id="api-key-field">
  <label for="ai-api-key" data-i18n="aiApiKey"></label>
  <input type="password" id="ai-api-key" placeholder="Enter your API key here...">
</div>

      <!-- Webhooks & Integration -->
      <div id="webhook-section">
        <h3 data-i18n="webhooksIntegration"></h3>
        <div class="field-group">
          <input type="text" id="webhook-url" data-i18n="webhookUrlPlaceholder" placeholder="Webhook URL (e.g., https://your.api/hook)">
          <div id="webhook-url-error" class="input-error" role="alert" aria-live="polite" hidden></div>
        </div>

        <div class="field-group checkbox-grid">
          <label><input type="checkbox" id="webhook-logging"><span data-i18n="enableWebhookLogging"></span></label>
          <label><input type="checkbox" id="webhook-only-fail"><span data-i18n="sendOnlyOnFailure"></span></label>
        </div>
      </div>
      <div class="field-group">
        <button id="reset-preferences" class="btn-danger button" data-i18n="resetPreferences"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="resetPreferences">Reset Preferences</span></span></button>
      </div>
    <div class="field-group preferences-footer">
      <span id="app-version"></span>
      <a class="report-bug-link" href="https://www.leadae.com/bug-report" target="_blank" data-i18n="reportBug">Report Bug</a>
    </div>
  </div>
  <div id="prefs-toast" class="toast" data-i18n="preferencesSaved"></div>
</div>

<!-- =======================
     LOG VIEWER PANEL
     ======================= -->
<div id="log-viewer" class="panel-section">
  <div class="section">
      <div class="panel-toolbar-controls log-viewer-toolbar">
        <div class="log-viewer-header-text">
          <span data-i18n="logViewerHeaderLine1">Review past tasks, errors,</span><br>
          <span data-i18n="logViewerHeaderLine2">and export log summaries.</span>
        </div>
        <div class="tooltip-container">
        <div class="icon">
          <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12" y2="8"></line>
          </svg>
        </div>
        <div class="tooltip tooltip-bottom" id="log-viewer-overview-tooltip"></div>
      </div>
    </div>

    <!-- Log Filters -->
    <h3><span data-i18n="logFilters"></span></h3>
    <div class="field-group">
      <label data-i18n="viewByDate"></label>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="" data-i18n="viewByDatePlaceholder">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="view-by-date" name="view-by-date">
      </div>
      <input type="date" id="log-start-date">
      <input type="date" id="log-end-date">

      <label data-i18n="viewByTool"></label>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="" data-i18n="viewByToolPlaceholder">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="view-by-tool" name="view-by-tool">
      </div>

      <label><input type="checkbox" id="show-errors-only"><span data-i18n="onlyErrorsWarnings"></span></label>
    </div>

    <!-- Log Search -->
    <h3 data-i18n="logDisplay">Log Display</h3>
    <div class="field-group">
      <input type="text" id="log-search" placeholder="" data-i18n="logSearch">
      <label><input type="checkbox" id="include-system-logs"><span data-i18n="includeSystemLogs"></span></label>
    </div>

    <!-- Live Log Output -->
     <div id="live-log-view" class="status-log" data-i18n="logsWillAppearHere"></div>

    <div class="field-group horizontal spaced-top">
      <button id="expand-task-details" data-i18n="expandTaskDetails" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="expandTaskDetails"></span></span></button>
      <button id="reset-log-viewer" class="btn-danger button" data-i18n="resetViewer"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="resetViewer"></span></span></button>
    </div>
    
      <!-- Export Section -->
      <h3><span data-i18n="exportLogs"></span></h3>
      <div class="field-group">
        <label data-i18n="logViewerExportFormat">Export Format</label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="" data-i18n="logViewerExportFormat">
          <ul class="value-list"></ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="export-format" name="export-format">
        </div>
      </div>

      <div class="field-group">
        <button id="select-export-folder" data-i18n="exportFolder" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="exportFolder"></span></span></button>
        <input type="text" id="export-folder-path" placeholder="Export folder path" data-i18n="exportFolderPath" readonly>
      </div>

    <button id="export-log-btn" data-i18n="exportLogs" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="exportLogs"></span></span></button>
    <div id="log-toast" class="toast" data-i18n="exportComplete"></div>
  </div>
</div>

<div id="transcribe" class="panel-section">
  <div class="section">
    <div class="panel-toolbar-controls">
      <button class="delete-preset-btn" data-panel="transcribe" title="Delete Preset" disabled>üóëÔ∏è</button>
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="" data-i18n="presetsPlaceholder">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="transcribe-preset" name="transcribe-preset">
      </div>
      <button id="transcribe-save-config" data-i18n="save" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="save"></span></span></button>
      <button id="transcribe-load-config" data-i18n="load" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="load"></span></span></button>

      <!-- üîπ Transcribe overview tooltip ‚Äì NEXT TO PRESETS, NOT ON THE FAR RIGHT -->
      <div class="tooltip-container">
        <div class="icon">
          <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12" y2="8"></line>
          </svg>
        </div>
        <div class="tooltip tooltip-bottom" id="transcribe-overview-tooltip"></div>
      </div>

        <!-- Spacer pushes ONLY the editor button to the far right -->
        <span class="toolbar-flex-spacer"></span>
        <button id="open-subtitle-editor" type="button" data-i18n="openEditor" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="openEditor">Open Editor‚Ä¶</span></span></button>
      </div>

    <div id="transcribe-lock-wrapper">

    <!-- Input -->
    <h3 data-i18n="transcribeInput">Input</h3>
    <div class="field-group">
      <button id="transcribe-select-files" data-i18n="transcribeSelectFiles" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="transcribeSelectFiles"></span></span></button>
      <textarea id="transcribe-files" data-i18n="transcribeNoSource" placeholder="" readonly rows="1"></textarea>
    </div>
    <div class="file-info-scroll">
      <div id="transcribe-file-info" class="file-info-grid placeholder">
        <div class="file-info-grid-header" data-i18n="fileInfoColumnFile"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnFormat"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnResolution"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnFps"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnAudio"></div>
        <div class="file-info-grid-header" data-i18n="fileInfoColumnDuration"></div>
      </div>
    </div>

    <!-- Output -->
    <h3 data-i18n="transcribeOutput">Output</h3>
    <div class="field-group">
      <button id="transcribe-output-select" data-i18n="transcribeOutputSelect" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="transcribeOutputSelect"></span></span></button>
      <input type="text" id="transcribe-output-path" placeholder="" data-i18n="transcribeNoDestination" readonly>
    </div>

    <!-- Engine Settings -->
    <div class="heading-with-tooltip">
      <h3><span data-i18n="engineSettings"></span></h3>
      <div class="tooltip-container">
        <div class="icon">
          <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12" y2="8"></line>
          </svg>
        </div>
        <div class="tooltip" id="transcribe-engine-tooltip"></div>
      </div>
    </div>
    <div class="video-grid-4col">
      <div class="form-item">
        <label for="transcribe-engine" data-i18n="engine"></label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="Engine">
          <ul class="value-list"></ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="transcribe-engine" name="transcribe-engine">
        </div>
      </div>
      <div class="form-item">
        <label for="transcribe-language" data-i18n="language"></label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="Language">
          <ul class="value-list"></ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="transcribe-language" name="transcribe-language">
        </div>
      </div>
      <div class="form-item">
        <label for="transcribe-accuracy-mode" data-i18n="accuracy"></label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="Accuracy">
          <ul class="value-list"></ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="transcribe-accuracy-mode" name="transcribe-accuracy-mode">
        </div>
      </div>
      <div class="form-item">
        <label for="transcribe-confidence" data-i18n="confidence"></label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="Confidence">
          <ul class="value-list"></ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="transcribe-confidence" name="transcribe-confidence">
        </div>
      </div>
    </div>
    <div class="field-group horizontal">
      <label><input type="checkbox" id="transcribe-offline"><span data-i18n="offlineOnly"></span></label>
      <label><input type="checkbox" id="transcribe-allow-fallback"><span data-i18n="enableFallback"></span></label>
    </div>

    <!-- 2. Output Format Presets -->
    <h3><span data-i18n="Output Formats"></span></h3>

    <!-- Global timecode controls deprecated in favor of per-format mini panels.
         Kept in DOM as internal defaults only, not shown to the user. -->
    <div class="field-group horizontal timecode-toggle-row" style="display:none;">
      <label><input type="checkbox" id="out-timecodes"><span data-i18n="includeTimecodes"></span></label>
    </div>
    <div id="timecode-fields" class="video-grid-3col" style="display:none;">
      <div class="form-item">
        <label for="transcribe-timecode-style">Timecode Format
        </label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="Timecode Format">
          <ul class="value-list"></ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="transcribe-timecode-style" name="transcribe-timecode-style">
        </div>
      </div>
      <div class="form-item">
        <label for="transcribe-fps">Frame Rate Override (FPS)
        </label>
        <input type="number" id="transcribe-fps" min="10" max="120" step="0.01" placeholder="Auto">
      </div>
      <div class="form-item">
        <label for="transcribe-tc-start" data-i18n="startTimecodeOffset"></label>
        <input type="text" id="transcribe-tc-start" placeholder="01:00:00:00">
      </div>
    </div>

    <pre id="sample-preview" class="status-log" data-i18n="selectFormatPreview"></pre>
    <div class="field-group">
      <div class="dropdown-wrapper dropdown-display">
        <input class="chosen-value" type="text" placeholder="Output Formats" data-i18n="Output Formats">
        <ul class="value-list"></ul>
        <span class="dropdown-arrow"></span>
        <input type="hidden" id="transcribe-output-formats" name="transcribe-output-formats">
      </div>
    </div>

  <!-- ‚¨áÔ∏è NEW: Plain Text (.txt) ‚Äî format-specific panel -->
  <details id="fmt-txt" class="format-options" data-format="txt" open style="display:none;">
    <summary><strong data-i18n="formatPlainText">Plain Text (.txt)</strong></summary>
    <div class="checkbox-grid fmt-txt-checkbox-row">
      <label class="checkbox-label">
        <input type="checkbox" id="fmt-txt-include-timecodes">
        <span data-i18n="includeTimecodes">Include Timecodes</span>
      </label>
      <label class="checkbox-label">
        <input type="checkbox" id="fmt-txt-group-by-speaker">
        <span data-i18n="groupBySpeaker">Group by Speaker</span>
      </label>
      <label class="checkbox-label">
        <input type="checkbox" id="fmt-txt-include-speaker-names">
        <span data-i18n="includeSpeakerNames">Include Speaker Names</span>
      </label>
    </div>
    <div class="video-grid-3col">
      <div class="form-item">
        <label for="fmt-txt-timecode-format" data-i18n="timecodeFormat">Timecode Format</label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="Timecode Format" data-i18n="timecodeFormat">
          <ul class="value-list">
            <li data-value="ndf" data-i18n="timecodeFormatNdf">NDF ‚Äî HH:MM:SS:FF</li>
            <li data-value="df" data-i18n="timecodeFormatDf">DF ‚Äî HH:MM:SS;FF</li>
            <li data-value="ms" data-i18n="timecodeFormatMs">Milliseconds ‚Äî HH:MM:SS,mmm</li>
          </ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="fmt-txt-timecode-format" name="fmt-txt-timecode-format">
        </div>
      </div>
      <div class="form-item">
        <label for="fmt-txt-fps" data-i18n="fpsOverride">Frame Rate Override (FPS)</label>
        <input type="number" id="fmt-txt-fps" min="1" max="120" step="0.001" placeholder="Auto">
      </div>
      <div class="form-item">
        <label for="fmt-txt-tc-start" data-i18n="startTimecodeOffset">Start Timecode Offset</label>
        <input type="text" id="fmt-txt-tc-start" value="01:00:00:00" placeholder="01:00:00:00">
      </div>
      <div class="form-item">
        <label for="fmt-txt-timestamp-placement" data-i18n="timestampPlacement">Timestamp Placement</label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="Timestamp Placement" data-i18n="timestampPlacement">
          <ul class="value-list">
            <li data-value="start_end" data-i18n="timestampPlacementStartEnd">Start‚ÄìEnd</li>
            <li data-value="start" data-i18n="timestampPlacementStartOnly">Start only</li>
            <li data-value="every_line" data-i18n="timestampPlacementEveryLine">Every line</li>
            <li data-value="none" data-i18n="timestampPlacementNone">None</li>
          </ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="fmt-txt-timestamp-placement" name="fmt-txt-timestamp-placement">
        </div>
      </div>
      <div class="form-item">
        <label for="fmt-txt-speaker-style" data-i18n="speakerLabelStyle">Speaker Label Style</label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="Speaker Label Style" data-i18n="speakerLabelStyle">
          <ul class="value-list">
            <li data-value="title" data-i18n="speakerTitleCase">Title Case</li>
            <li data-value="caps" data-i18n="speakerAllCaps">ALL CAPS</li>
            <li data-value="raw" data-i18n="speakerRaw">Raw</li>
          </ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="fmt-txt-speaker-style" name="fmt-txt-speaker-style">
        </div>
        </div>
      </div>
    </details>

  <!-- Final JSON (wrapped) ‚Äî format-specific panel -->
  <details id="fmt-finaljson" class="format-options" data-format="finalJson" open style="display:none;">
    <summary><strong data-i18n="formatFinalJson">Final JSON (wrapped)</strong></summary>

      <div class="video-grid-3col">
        <div class="form-item">
        <label for="fmt-finaljson-timecode-format" data-i18n="timecodeFormat">Timecode Format</label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="Timecode Format" data-i18n="timecodeFormat">
          <ul class="value-list">
            <li data-value="ndf" data-i18n="timecodeFormatNdf">NDF ‚Äî HH:MM:SS:FF</li>
            <li data-value="df" data-i18n="timecodeFormatDf">DF ‚Äî HH:MM:SS;FF</li>
            <li data-value="ms" data-i18n="timecodeFormatMs">Milliseconds ‚Äî HH:MM:SS,mmm</li>
          </ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="fmt-finaljson-timecode-format" name="fmt-finaljson-timecode-format">
        </div>
      </div>
      <div class="form-item">
        <label for="fmt-finaljson-fps" data-i18n="fpsOverride">Frame Rate Override (FPS)</label>
        <input type="number" id="fmt-finaljson-fps" min="1" max="120" step="0.001" placeholder="Auto">
      </div>
      <div class="form-item">
        <label for="fmt-finaljson-tc-start" data-i18n="startTimecodeOffset">Start Timecode Offset</label>
        <input type="text" id="fmt-finaljson-tc-start" placeholder="01:00:00:00">
      </div>
      <div class="form-item">
        <label class="checkbox-label">
          <input type="checkbox" id="fmt-finaljson-pretty" checked>
          <span data-i18n="prettyPrint">Pretty print (2-space)</span>
        </label>
      </div>
      </div>
    </details>

    <!-- SubRip (.srt) ‚Äî no per-format mini-panel.
         SRT now behaves like XML: only the main "Output Formats" dropdown controls whether it‚Äôs generated. -->

  <!-- WebVTT (.vtt) ‚Äî format-specific panel -->
  <details id="fmt-vtt" class="format-options" data-format="vtt" open style="display:none;">
    <summary><strong data-i18n="formatWebVtt">WebVTT (.vtt)</strong></summary>

      <div class="video-grid-3col align-end">

        <!-- Include Speaker Names -->
        <div class="form-item">
          <label class="checkbox-label nowrap">
            <input type="checkbox" id="fmt-vtt-include-speaker-names">
            <span data-i18n="includeSpeakerNames">Include Speaker Names</span>
          </label>
        </div>

        <!-- Speaker Label Style dropdown (NO visible header label) -->
        <div class="form-item">
          <div class="dropdown-wrapper dropdown-display">
            <input class="chosen-value" type="text" placeholder="Speaker Label Style" data-i18n="speakerLabelStyle">
            <ul class="value-list">
              <li data-value="title" data-i18n="speakerTitleCase">Title Case</li>
              <li data-value="caps" data-i18n="speakerAllCaps">ALL CAPS</li>
              <li data-value="raw" data-i18n="speakerRaw">Raw</li>
            </ul>
            <span class="dropdown-arrow"></span>
            <input type="hidden" id="fmt-vtt-speaker-style" name="fmt-vtt-speaker-style">
          </div>
        </div>

        <!-- VTT style metadata toggle (per-format) -->
        <div class="form-item">
          <label>
            <input type="checkbox" id="fmt-vtt-include-style">
            <span data-i18n="includeWebvttStyleMetadata">Include WebVTT style metadata</span>
          </label>
        </div>
      </div>

      <!-- WebVTT subtitle shaping options (moved from Subtitle Options) -->
      <div class="video-grid-3col">
        <div class="form-item">
          <label for="sub-max-chars" data-i18n="maxCharsPerLine"></label>
          <input type="number" id="sub-max-chars" value="42">
        </div>
        <div class="form-item">
          <label for="sub-max-lines" data-i18n="maxLinesPerBlock"></label>
          <input type="number" id="sub-max-lines" value="2">
        </div>
        <div class="form-item">
          <label for="sub-max-duration" data-i18n="maxSubtitleDuration"></label>
          <input type="number" step="0.1" id="sub-max-duration" value="6.0">
        </div>
      </div>
    </details>

<!-- Scenarist SCC (.scc) ‚Äî format-specific mini panel -->
<details id="fmt-scc" class="format-options" data-format="scc" open style="display:none;">
  <summary><strong data-i18n="formatScc">Scenarist Closed Captions (.scc) ‚Äî BETA (CC1 only)</strong></summary>

      <!-- Shaping (SCC defaults) -->
    <div class="video-grid-3col">
      <div class="form-item">
        <label for="fmt-scc-max-chars" data-i18n="sccMaxCharsPerLine">Max characters per line</label>
        <input type="number" id="fmt-scc-max-chars" value="28" min="20" max="32">
      </div>
      <div class="form-item">
        <label for="fmt-scc-max-lines" data-i18n="sccMaxLinesPerBlock">Max lines per subtitle block</label>
        <input type="number" id="fmt-scc-max-lines" value="2" min="1" max="2">
      </div>
      <div class="form-item">
        <label for="fmt-scc-max-duration" data-i18n="sccMaxDuration">Max subtitle duration (sec.)</label>
        <input type="number" step="0.1" id="fmt-scc-max-duration" value="6.0" min="1" max="10">
      </div>
    </div>

    <!-- SCC Primary Controls (ONLY shown when SCC selected) -->
    <div class="video-grid-2col" id="scc-primary-row">
      <div class="form-item" id="scc-starttc-slot">
        <!-- Start TC is injected here by renderer.transcribe.js -->
      </div>

      <div class="form-item" id="scc-align-row">
        <label for="scc-alignment" data-i18n="captionAlignment">Caption Alignment</label>
        <div class="dropdown-wrapper dropdown-display compact">
          <input class="chosen-value" type="text" placeholder="Alignment" data-i18n="captionAlignment">
          <ul class="value-list"></ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="scc-alignment" name="scc-alignment">
        </div>
      </div>
    </div>

    <!-- Advanced SCC / QC controls (broadcast deliverables vary) -->
    <details id="fmt-scc-advanced" style="margin-top: 0.5rem;">
      <summary><strong>Advanced SCC &amp; QC</strong></summary>

      <div class="scc-advanced-top">
        <div class="scc-advanced-checks">
          <div class="form-item">
            <label class="checkbox-label">
              <input id="fmt-scc-allow-ndf" type="checkbox">
              Allow NDF timecode for SCC (HH:MM:SS:FF)
            </label>
          </div>
          <div class="form-item">
            <label class="checkbox-label">
              <input id="fmt-scc-repeat-control" type="checkbox" checked>
              Repeat control codes (RCL/EDM/ENM/EOC)
            </label>
          </div>
          <div class="form-item">
            <label class="checkbox-label">
              <input id="fmt-scc-repeat-preamble" type="checkbox" checked>
              Repeat PAC (preamble) codes
            </label>
          </div>
          <div class="form-item">
            <label class="checkbox-label">
              <input id="fmt-scc-strip-leading-dashes" type="checkbox">
              Strip leading dashes
            </label>
          </div>
          <div class="form-item">
            <label class="checkbox-label">
              <input id="fmt-scc-pad-even" type="checkbox">
              Pad even SCC word-count (NOP fill)
            </label>
          </div>
        </div>

        <div class="scc-advanced-grid">
          <div class="form-item">
            <label for="fmt-scc-safe-left">Safe margin left (cols)</label>
            <input type="number" id="fmt-scc-safe-left" min="0" max="15" step="1" value="0">
          </div>
          <div class="form-item">
            <label for="fmt-scc-safe-right">Safe margin right (cols)</label>
            <input type="number" id="fmt-scc-safe-right" min="0" max="15" step="1" value="0">
          </div>
          <div class="form-item">
            <label for="fmt-scc-time-source">SCC timing anchor</label>
            <div class="dropdown-wrapper dropdown-display">
              <input class="chosen-value" type="text" placeholder="SCC timing anchor">
              <ul class="value-list"></ul>
              <span class="dropdown-arrow"></span>
              <input type="hidden" id="fmt-scc-time-source" name="fmt-scc-time-source">
            </div>
          </div>
          <div class="form-item">
            <label for="fmt-scc-start-reset-at">Start reset line</label>
            <div class="dropdown-wrapper dropdown-display">
              <input class="chosen-value" type="text" placeholder="Start reset line">
              <ul class="value-list"></ul>
              <span class="dropdown-arrow"></span>
              <input type="hidden" id="fmt-scc-start-reset-at" name="fmt-scc-start-reset-at">
            </div>
          </div>
          <div class="form-item">
            <label for="fmt-scc-start-reset-op">Start reset op</label>
            <div class="dropdown-wrapper dropdown-display">
              <input class="chosen-value" type="text" placeholder="Start reset op">
              <ul class="value-list"></ul>
              <span class="dropdown-arrow"></span>
              <input type="hidden" id="fmt-scc-start-reset-op" name="fmt-scc-start-reset-op">
            </div>
          </div>
          <div class="form-item">
            <label for="fmt-scc-prefix-words">Prefix SCC words</label>
            <input id="fmt-scc-prefix-words" type="text" placeholder="e.g. 9420 94ae">
          </div>
        </div>
      </div>

      <hr>

      <div class="video-grid-3col">
        <div class="form-item">
          <label for="fmt-scc-qc-max-cps">QC max CPS (chars/sec)</label>
          <input type="number" id="fmt-scc-qc-max-cps" min="1" max="60" step="0.1" value="20">
        </div>
        <div class="form-item">
          <label for="fmt-scc-qc-max-wpm">QC max WPM</label>
          <input type="number" id="fmt-scc-qc-max-wpm" min="10" max="400" step="1" value="180">
        </div>
        <div class="form-item">
          <label for="fmt-scc-qc-min-duration">QC min duration (sec)</label>
          <input type="number" id="fmt-scc-qc-min-duration" min="0" max="10" step="0.01" value="0.8">
        </div>
      </div>

      <div class="video-grid-3col">
        <div class="form-item">
          <label for="fmt-scc-qc-min-gap">QC min gap (sec)</label>
          <input type="number" id="fmt-scc-qc-min-gap" min="0" max="10" step="0.01" value="0.1">
        </div>
        <div class="form-item">
          <label for="fmt-scc-qc-max-late-eoc">QC max late EOC (sec)</label>
          <input type="number" id="fmt-scc-qc-max-late-eoc" min="0" max="2" step="0.01" value="0.1">
        </div>
        <div class="form-item">
          <label for="fmt-scc-qc-max-late-eoc-count">QC max late EOC count</label>
          <input type="number" id="fmt-scc-qc-max-late-eoc-count" min="0" max="999" step="1" value="0">
        </div>
      </div>
    </details>

  </details>

<!-- Scripted (CSV/DOCX) ‚Äî format-specific panel -->
<details id="fmt-script" class="format-options" data-format="script" open style="display:none;">
  <summary><strong data-i18n="formatScripted">Scripted (CSV/DOCX)</strong></summary>

      <!-- Row 1: core Scripted checkboxes -->
    <div class="video-grid-3col align-end">
      <div class="form-item">
        <label class="checkbox-label nowrap">
          <input type="checkbox" id="fmt-script-include-timecodes">
          <span data-i18n="includeTimecodes">Include Timecodes</span>
        </label>
      </div>

        <div class="form-item">
        <label class="checkbox-label nowrap">
          <input type="checkbox" id="fmt-script-include-speaker-names">
          <span data-i18n="includeSpeakerNames">Include Speaker Names</span>
        </label>
      </div>

        <div class="form-item">
        <label class="checkbox-label nowrap">
          <input type="checkbox" id="fmt-script-group-by-speaker">
          <span data-i18n="groupBySpeaker">Group by Speaker</span>
        </label>
      </div>
    </div>

      <!-- Row 2: Timestamp placement + speaker label style + export type -->
    <div class="video-grid-3col">
      <div class="form-item">
        <label for="fmt-script-timestamp-placement" data-i18n="timestampPlacement">Timestamp Placement</label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="Timestamp Placement" data-i18n="timestampPlacement">
          <ul class="value-list">
            <li data-value="start_end" data-i18n="timestampPlacementStartEnd">Start‚ÄìEnd</li>
            <li data-value="start" data-i18n="timestampPlacementStartOnly">Start only</li>
            <li data-value="every_line" data-i18n="timestampPlacementEveryLine">Every line</li>
            <li data-value="none" data-i18n="timestampPlacementNone">None</li>
          </ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="fmt-script-timestamp-placement" name="fmt-script-timestamp-placement">
        </div>
      </div>

        <div class="form-item">
        <label for="fmt-script-speaker-style" data-i18n="speakerLabelStyle">Speaker Label Style</label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="Speaker Label Style" data-i18n="speakerLabelStyle">
          <ul class="value-list">
            <li data-value="title" data-i18n="speakerTitleCase">Title Case</li>
            <li data-value="caps" data-i18n="speakerAllCaps">ALL CAPS</li>
            <li data-value="raw" data-i18n="speakerRaw">Raw</li>
          </ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="fmt-script-speaker-style" name="fmt-script-speaker-style">
        </div>
      </div>

        <div class="form-item">
        <label for="fmt-script-export" data-i18n="exportType">Export Type</label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="Export Type" data-i18n="exportType">
          <ul class="value-list">
            <li data-value="csv" data-i18n="exportTypeCsv">CSV (FCP7-style)</li>
            <li data-value="docx" data-i18n="exportTypeDocx">DOCX (Word)</li>
          </ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="fmt-script-export" name="fmt-script-export">
        </div>
      </div>
      </div>

      <!-- Row 3: Timecode specifics scoped to Scripted -->
      <div class="video-grid-3col">
        <div class="form-item">
        <label for="fmt-script-timecode-format" data-i18n="timecodeFormat">Timecode Format</label>
        <div class="dropdown-wrapper dropdown-display">
          <input class="chosen-value" type="text" placeholder="Timecode Format" data-i18n="timecodeFormat">
          <ul class="value-list">
            <li data-value="ndf" data-i18n="timecodeFormatNdf">NDF ‚Äî HH:MM:SS:FF</li>
            <li data-value="df" data-i18n="timecodeFormatDf">DF ‚Äî HH:MM:SS;FF</li>
            <li data-value="ms" data-i18n="timecodeFormatMs">Milliseconds ‚Äî HH:MM:SS,mmm</li>
          </ul>
          <span class="dropdown-arrow"></span>
          <input type="hidden" id="fmt-script-timecode-format" name="fmt-script-timecode-format">
        </div>
      </div>
      <div class="form-item">
        <label for="fmt-script-fps" data-i18n="fpsOverride">Frame Rate Override (FPS)</label>
        <input type="number" id="fmt-script-fps" min="1" max="120" step="0.001" placeholder="Auto">
      </div>
      <div class="form-item">
        <label for="fmt-script-tc-start" data-i18n="startTimecodeOffset">Start Timecode Offset</label>
        <input type="text" id="fmt-script-tc-start" value="01:00:00:00" placeholder="01:00:00:00">
      </div>
    </div>
  </details>

    <!-- SCC-only: Row policy (row pair) -->
<div class="field-group horizontal" id="scc-row-policy-row" style="display:none;">
  <label for="scc-row-policy" data-i18n="rowPolicy">Row policy</label>
  <div class="dropdown-wrapper dropdown-display compact">
    <input class="chosen-value" type="text" placeholder="Row policy" data-i18n="rowPolicy">
    <ul class="value-list"></ul>
    <span class="dropdown-arrow"></span>
    <input type="hidden" id="scc-row-policy" name="scc-row-policy">
      </div>
    </div>

    <!-- (Removed legacy SCC rows: mode, roll-up clear, EOF/EDM, legacy font comment, XML sidecar) -->

<!-- 3. Enhancements -->
      <details>
        <summary><strong><span data-i18n="enhancements"></span></strong></summary>

          <div class="checkbox-grid spaced-top enhancements-grid">
            <!-- Audio Analysis -->
            <label class="enhancement-heading" data-i18n="enhancementAudioAnalysis">Audio Analysis</label>
            <label><input type="checkbox" id="transcribe-use-tracks"><span data-i18n="useAltAudioTrack"></span></label>
            <label><input type="checkbox" id="acc-boost"><span data-i18n="boostClarity"></span></label>

            <!-- Text Enhancement -->
            <label class="enhancement-heading" data-i18n="enhancementTextEnhancement">Text Enhancement</label>
            <label><input type="checkbox" id="acc-auto-punct"><span data-i18n="autoPunctuate"></span></label>
            <label><input type="checkbox" id="acc-smart-cap"><span data-i18n="smartCapitalization"></span></label>
            <label><input type="checkbox" id="acc-spellcheck"><span data-i18n="spellcheck"></span></label>

            <!-- Safety Filters -->
            <label class="enhancement-heading" data-i18n="enhancementSafetyFilters">Safety Filters</label>
            <label><input type="checkbox" id="acc-redact"><span data-i18n="redactExplicit"></span></label>

            <!-- Content Cleanup -->
            <label class="enhancement-heading" data-i18n="enhancementContentCleanup">Content Cleanup</label>
            <label>
              <input type="checkbox" id="transcribe-filter-nonspeech">
              <span data-i18n="removeNonSpeech"></span>
          </label>
          <label>
            <input type="checkbox" id="transcribe-remove-fillers">
            <span data-i18n="removeFillers"></span>
          </label>
            <label><input type="checkbox" id="transcribe-rename"><span data-i18n="renameMatchSource"></span></label>

            <!-- Metadata / Export -->
            <label class="enhancement-heading" data-i18n="enhancementMetadataExport">Metadata / Export</label>
            <label>
              <input type="checkbox" id="transcribe-embed">
              <span data-i18n="embedInMetadata"></span>
          </label>
        </div>
      </details>

      <!-- 4. Translate -->
      <details>
        <summary><strong><span data-i18n="translate"></span></strong></summary>
        <div class="field-group horizontal">
            <label><input type="checkbox" id="translate-enable"><span data-i18n="translateOutput"></span></label>
            <div class="dropdown-wrapper dropdown-display">
              <input class="chosen-value" type="text" placeholder="Language" data-i18n="languageLabel">
              <ul class="value-list"></ul>
              <span class="dropdown-arrow"></span>
              <input type="hidden" id="translate-target" name="translate-target">
          </div>
          <label><input type="checkbox" id="translate-side-by-side"><span data-i18n="translateSideBySide"></span></label>
        </div>
      </details>
      
        <!-- Automation / Webhook Integration -->
    <details data-webhook-section>
      <summary><strong><span data-i18n="automationIntegration"></span></strong></summary>

      <div class="field-group">
        <label><input type="checkbox" id="transcribe-enable-n8n"><span data-i18n="transcribeEnableN8N"></span></label>
        <input type="text" id="transcribe-n8n-url" placeholder="" data-i18n="transcribeN8NUrl">
        <label><input type="checkbox" id="transcribe-n8n-log"><span data-i18n="transcribeN8NLog"></span></label>
      </div>

    </details>

    <!-- Watch Mode -->
    <details>
      <summary><strong><span data-i18n="watchMode"></span></strong></summary>
      <div class="field-group">
        <label><input type="checkbox" id="transcribe-watch-mode"><span data-i18n="enableWatchMode"></span></label>
        <span id="transcribe-watch-state" class="watch-state"></span>
      </div>
    </details>

    <!-- 5. File Output & Post-Actions -->

    <!-- Summary Preview -->
      <pre id="live-transcript-output" class="whitespace-pre-wrap p-2 border rounded h-64 overflow-y-auto bg-black text-white font-mono text-sm"></pre>

      <textarea id="transcribe-notes" placeholder="" data-i18n="transcribeNotes"></textarea>

      <!-- Controls -->
    <div class="field-group horizontal" id="transcribe-controls-row">
      <button id="start-transcribe" data-i18n="startTranscribe" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="startTranscribe"></span></span></button>
      <button id="reset-transcribe" class="btn-danger button" data-i18n="resetTranscribe"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="resetTranscribe"></span></span></button>
      <button id="cancel-transcribe" class="btn-danger button" data-i18n="cancelTranscribe"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="cancelTranscribe"></span></span></button>

        <!-- Inline status text (replaces progress bar) -->
        <div id="transcribe-loader-inline" aria-live="polite" style="display:none">
          <span class="eta-inline" id="transcribe-status-text" data-i18n="transcribeStatusTranscribing">transcribing...</span>
        </div>

      <!-- Hamster wheel, right-aligned (same structure as other panels) -->
      <div id="transcribe-job-status" style="display:none;">
        <div class="wheel-and-hamster"></div>
      </div>
    </div>

    </div> <!-- end of transcribe-lock-wrapper -->

    <!-- Summary -->
      <h3><span data-i18n="summary"></span></h3>
      <div id="transcribe-summary" class="status-log"></div>

    <!-- (progress bar removed; indeterminate spinner + text is shown inline above) -->
  </div>
</div>

<!-- ==================== SPEED TEST PANEL ==================== -->
<div id="speed-test" class="panel-section hidden">
  <div class="section">
    <div class="panel-toolbar-controls">
      <div class="tooltip-container">
        <div class="icon">
          <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12" y2="8"></line>
          </svg>
        </div>
        <div class="tooltip tooltip-bottom" id="speed-test-overview-tooltip"></div>
      </div>
    </div>

    <!-- Network Test -->
    <h3><span data-i18n="networkTest"></span></h3>
    <div class="field-group horizontal">
      <button id="start-network-test" data-i18n="runNetworkTest" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="runNetworkTest"></span></span></button>
      <div id="network-test-inline-status" aria-live="polite" aria-atomic="true" aria-hidden="true"></div>
      <!-- üêπ Network speed test hamster (independent of drive tests) -->
      <div id="speedtest-network-job-status" aria-hidden="true"></div>
    </div>

    <h3><span data-i18n="summary"></span></h3>
    <div id="network-test-results" class="status-log spaced-bottom"><span data-i18n="noNetworkResults"></span></div>
    
    <!-- Drive Tests -->
    <div class="heading-with-tooltip">
      <h3><span data-i18n="driveTests"></span></h3>
      <div class="tooltip-container">
        <div class="icon">
          <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12" y2="8"></line>
          </svg>
        </div>
        <div class="tooltip" id="speedtest-info-tooltip"></div>
      </div>
    </div>
    <div id="drive-tests" class="spaced-top">
      <div class="field-group horizontal">
        <button id="select-drive-1" data-i18n="selectDrive1" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="selectDrive1"></span></span></button>
        <button id="select-drive-2" data-i18n="selectDrive2" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="selectDrive2"></span></span></button>
        <button id="select-drive-3" data-i18n="selectDrive3" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="selectDrive3"></span></span></button>
      </div>
      <div id="selected-drive-paths" class="status-log" data-i18n="noDrivesSelected"></div>
      <div class="video-grid-2col spaced-top">
        <div class="form-item">
          <label for="test-size" data-i18n="testSize">Test Size</label>
          <div class="dropdown-wrapper dropdown-display">
            <input class="chosen-value" type="text" placeholder="Select Test Size">
            <ul class="value-list"></ul>
            <span class="dropdown-arrow"></span>
            <input type="hidden" id="test-size" name="test-size">
          </div>
        </div>

        <div class="form-item">
          <label for="io-mode" data-i18n="mode">Mode</label>
          <div class="dropdown-wrapper dropdown-display">
            <input class="chosen-value" type="text" placeholder="Select Mode">
            <ul class="value-list"></ul>
            <span class="dropdown-arrow"></span>
            <input type="hidden" id="io-mode" name="io-mode">
          </div>
        </div>
      </div>

      <!-- Run Test Button + inline progress + hamster (same row) -->
      <div class="field-group horizontal spaced-top" id="speedtest-controls-row">
        <button id="test-selected-drives" data-i18n="testSelectedDrives" class="button"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="testSelectedDrives"></span></span></button>
        <button id="reset-speedtest" class="btn-danger button" data-i18n="resetSpeedTest"><span class="button_lg"><span class="button_sl"></span><span class="button_text" data-i18n="resetSpeedTest"></span></span></button>

        <div id="speedtest-loader-inline" aria-live="polite">
          <progress id="speedtest-progress" max="100" value="0"></progress>
          <output id="speedtest-progress-output"></output>
        </div>

        <!-- Hamster, same structure/scale used in other panels -->
        <div id="speedtest-job-status" aria-hidden="true"></div>
      </div>
    </div>

    <!-- Summary of drive tests -->
    <h3><span data-i18n="summary"></span></h3>
    <div id="drive-test-results" class="status-log"><span data-i18n="noDriveResults"></span></div>

  </div>
</div>

      </main>
    </div>
<!-- window-content -->
    </div>
<!-- app -->

<!-- ‚öôÔ∏è App Logic Script -->
  <!-- Load CSInterface only inside CEP -->
  <script>
    (function () {
      if (window.__adobe_cep__) {
        var s = document.createElement('script');
        s.src = 'resources/cep/extensions/com.leadae.panel/CSInterface.js';
        document.head.appendChild(s);
      }
    })();
  </script>
  <script src="./node_modules/i18next/dist/umd/i18next.min.js"></script>
  <script src="./node_modules/i18next-browser-languagedetector/dist/umd/i18nextBrowserLanguageDetector.min.js"></script>
  <script src="i18n.js"></script>
  <script src="utils/dropdown.js" defer></script>
  <script src="renderer.clone-utils.js" defer></script>
  <script src="utils/watch-mode.js" defer></script>
  <script id="panel-script-speed-test" src="./dist-obfuscated/renderer.speed-test.js" defer onerror="this.onerror=null;this.remove();const f=document.createElement('script');f.defer=true;f.id='panel-script-speed-test';f.src='./renderer.speed-test.js';document.head.appendChild(f);"></script>
  <script src="./dist-obfuscated/renderer.js" defer></script>
  <script>
  // Theme and initial panel setup; pop-out bootstrap handled in renderer.js to avoid duplicate loads.
  document.addEventListener('DOMContentLoaded', () => {
    const storedTheme = localStorage.getItem('theme');
    if (storedTheme) {
      document.body.classList.toggle('dark-mode', storedTheme === 'dark');
    }

    const isEditorWin = new URLSearchParams(location.search).get('win') === 'subtitle-editor';
    if (!isEditorWin) {
      document.querySelectorAll('.panel-section').forEach(panel => panel.classList.add('hidden'));
      window.electron?.send?.('ui:set-collapsed', true);
    }
  });
  </script>

  <!-- ‚¨áÔ∏è NEW: Format-scope logic for Plain Text (.txt) -->
  <script>
  (function () {
    function parseSelectedFormats() {
      const hidden = document.getElementById('transcribe-output-formats');
      if (!hidden) return [];
      const raw = hidden.value?.trim();
      if (!raw) return [];
      try {
        // Support either CSV or JSON array, depending on dropdown implementation
        if (raw.startsWith('[')) return JSON.parse(raw).map(String);
      } catch (_) {}
      return raw.split(',').map(s => s.trim()).filter(Boolean);
    }

    function show(el, on) { if (el) el.style.display = on ? '' : 'none'; }

    function updateTxtPanel() {
      const formats = parseSelectedFormats();
      const txtSelected = formats.some(f => f === 'txt' || f === '.txt' || f === 'plain_text');
      const finalJsonSelected = formats.some(f => f === 'finalJson');
      const scriptedSelected = formats.some(f => f === 'script');
      const sccSelected = formats.some(f => f === 'scc' || f === '.scc');

      // Show/hide the TXT-specific mini-panel
      show(document.getElementById('fmt-txt'), txtSelected);

      // Show/hide the VTT-specific mini-panel
      const vttSelected = formats.some(f => f === 'vtt' || f === '.vtt');
      show(document.getElementById('fmt-vtt'), vttSelected);

      // Show/hide the SCC-specific mini-panel
      show(document.getElementById('fmt-scc'), sccSelected);

      // Show/hide the Final JSON mini-panel
      show(document.getElementById('fmt-finaljson'), finalJsonSelected);

      // Show/hide the Scripted-specific mini-panel
      show(document.getElementById('fmt-script'), scriptedSelected);

    }

    // Wire up listeners after DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      const hidden = document.getElementById('transcribe-output-formats');
      ['change', 'input', 'dropdown:change'].forEach(ev => hidden?.addEventListener(ev, updateTxtPanel));
      updateTxtPanel();
    });
  })();
  </script>
</body>
</html>
